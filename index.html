<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>APUNTADO</title>

<style>
/* ========= RESET SANO ========= */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html, body {
  width: 100%;
  height: 100%;
  overflow-x: hidden; /* ðŸ”’ clave */
  background: #000;
  color: #fff;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}

/* ========= CONTENEDOR ========= */
.app {
  width: 100%;
  min-height: 100vh;
  padding: 6px; /* margen lateral fino */
  display: flex;
  flex-direction: column;
}

/* ========= HEADER ========= */
header {
  text-align: center;
  margin-bottom: 10px;
}

header h1 {
  font-size: 28px;
  letter-spacing: 2px;
}

/* ========= CONTROLES ========= */
.controls {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

select, button {
  background: #111;
  color: #fff;
  border: 1px solid #444;
  padding: 8px 12px;
  font-size: 16px;
  border-radius: 6px;
}

button:active {
  transform: scale(0.97);
}

/* ========= TABLERO ========= */
.board {
  flex: 1;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
}

/* ========= JUGADOR ========= */
.player {
  border: 1px solid #333;
  border-radius: 8px;
  padding: 6px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  min-height: 120px;
}

/* Nombre */
.player-name {
  text-align: center;
  font-weight: bold;
  font-size: 18px;
  outline: none;
}

/* LÃ­nea divisora */
.divider {
  height: 1px;
  background: #333;
  margin: 6px 0;
}

/* Puntaje */
.score {
  text-align: center;
  font-size: 28px;
  outline: none;
}

/* ENTRADAS */
.entry {
  text-align: center;
  font-size: 12px;
  color: #ffd700;
}

/* Ganador */
.winner {
  border-color: gold;
}

.winner .player-name {
  font-weight: 900;
}

.disabled {
  opacity: 0.35;
}

/* ========= FOOTER ========= */
footer {
  margin-top: 10px;
  display: flex;
  justify-content: center;
}

footer button {
  border-color: #700;
  color: #f88;
}
</style>
</head>

<body>
<div class="app">

<header>
  <h1>APUNTADO</h1>
</header>

<div class="controls">
  <label>Jugadores</label>
  <select id="playerCount">
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
  </select>
  <button id="undoBtn">DESHACER</button>
</div>

<div class="board" id="board"></div>

<footer>
  <button id="resetBtn">REINICIAR</button>
</footer>

</div>

<script>
const board = document.getElementById('board');
const playerCount = document.getElementById('playerCount');
let history = [];

/* ========= CREAR JUGADORES ========= */
function createPlayers(count) {
  board.innerHTML = '';
  for (let i = 1; i <= count; i++) {
    const div = document.createElement('div');
    div.className = 'player';
    div.innerHTML = `
      <div class="player-name" contenteditable>NOMBRE ${i}</div>
      <div class="entry"></div>
      <div class="divider"></div>
      <div class="score" contenteditable>0</div>
    `;
    board.appendChild(div);
    bindPlayer(div);
  }
}

/* ========= EVENTOS ========= */
function bindPlayer(player) {
  const name = player.querySelector('.player-name');
  const score = player.querySelector('.score');

  name.addEventListener('focus', () => selectAll(name));
  score.addEventListener('focus', () => selectAll(score));

  score.addEventListener('input', () => {
    saveState();
    checkWinner();
  });
}

/* ========= UTIL ========= */
function selectAll(el) {
  const range = document.createRange();
  range.selectNodeContents(el);
  const sel = window.getSelection();
  sel.removeAllRanges();
  sel.addRange(range);
}

function saveState() {
  history.push(board.innerHTML);
}

function undo() {
  if (history.length > 0) {
    board.innerHTML = history.pop();
    document.querySelectorAll('.player').forEach(bindPlayer);
  }
}

/* ========= GANADOR ========= */
function checkWinner() {
  const players = document.querySelectorAll('.player');
  let active = [];

  players.forEach(p => {
    const score = parseInt(p.querySelector('.score').innerText) || 0;
    p.classList.remove('winner', 'disabled');
    if (score <= -51) active.push(p);
  });

  if (active.length === 1) {
    active[0].classList.add('winner');
    players.forEach(p => {
      if (p !== active[0]) p.classList.add('disabled');
    });
  }
}

/* ========= BOTONES ========= */
playerCount.addEventListener('change', () => {
  createPlayers(parseInt(playerCount.value));
  history = [];
});

document.getElementById('undoBtn').onclick = undo;

document.getElementById('resetBtn').onclick = () => {
  if (confirm('Â¿Reiniciar el juego?')) {
    createPlayers(parseInt(playerCount.value));
    history = [];
  }
};

/* ========= INICIO ========= */
createPlayers(parseInt(playerCount.value));
</script>

</body>
</html>